/*
 * Copyright (C) 2016 Florin Petriuc. All rights reserved.
 * Initial release: Florin Petriuc <petriuc.florin@gmail.com>
 *
 * This program is free software; you can redistribute it and/or
 * modify it under the terms of the GNU General Public License version
 * 2 as published by the Free Software Foundation.
 *
 * This program is distributed in the hope that it will be useful, but
 * WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * General Public License for more details.
 */

#include "../libfirebase.h"

static int hkdf_test()
{
    const unsigned char salt[16] = { 50, 202, 2, 1, 253, 47, 45, 182, 81, 189, 70, 30, 56, 138, 242, 124 };
    const unsigned char ikm[32] = { 183, 91, 115, 9, 91, 166, 119, 79, 199, 195, 160, 15, 137, 144, 74, 211, 36, 92, 128, 242, 109, 163, 19, 248, 104, 168, 117, 235, 213, 46, 98, 5 };
    const unsigned char info[23] = { 67, 111, 110, 116, 101, 110, 116, 45, 69, 110, 99, 111, 100, 105, 110, 103, 58, 32, 97, 117, 116, 104, 0 };
    const unsigned char result[32] = { 82, 106, 51, 214, 122, 141, 134, 215, 43, 41, 51, 15, 248, 7, 24, 23, 126, 57, 80, 121, 19, 113, 31, 66, 44, 206, 134, 253, 254, 124, 53, 199 };

    unsigned char *res;

    res = env_generate_hkdf(salt, 16, ikm, 32, info, 23);

    if(memcmp(res, result, 32))
    {
        env_logWrite(LOG_TYPE_ERROR, "hkdf_test has failed!", 0);

        return 1;
    }

    free(res);

    return 0;
}

static int create_info_chunk_test()
{
    unsigned int i;

    const char *p1 = "aesgcm";
    const unsigned char p2[] = { 4, 255, 245, 125, 106, 37, 130, 178, 0, 141, 62, 206, 93, 218,
                                77, 63, 1, 11, 113, 109, 169, 156, 29, 206, 183, 75, 8, 242, 75,
                                120, 74, 107, 129, 98, 119, 96, 91, 26, 161, 247, 50, 152, 86,
                                156, 61, 132, 206, 24, 211, 15, 40, 175, 5, 171, 255, 48, 47,
                                127, 33, 72, 34, 129, 212, 156, 118 };
    const unsigned char p3[] = { 4, 46, 70, 170, 197, 186, 17, 239, 24, 102, 125, 74, 197, 135,
                                 5, 203, 94, 153, 1, 148, 113, 136, 131, 10, 155, 220, 9, 102,
                                 159, 172, 156, 33, 79, 211, 57, 8, 185, 232, 59, 184, 177, 251,
                                 136, 203, 236, 152, 238, 194, 185, 9, 21, 224, 174, 158, 192,
                                 31, 191, 24, 254, 84, 188, 106, 158, 214, 48 };
    const unsigned char res[] =  { 67, 111, 110, 116, 101, 110, 116, 45, 69, 110, 99, 111, 100,
                                   105, 110, 103, 58, 32, 97, 101, 115, 103, 99, 109, 0, 80, 45,
                                   50, 53, 54, 0, 0, 65, 4, 255, 245, 125, 106, 37, 130, 178, 0,
                                   141, 62, 206, 93, 218, 77, 63, 1, 11, 113, 109, 169, 156, 29,
                                   206, 183, 75, 8, 242, 75, 120, 74, 107, 129, 98, 119, 96, 91,
                                   26, 161, 247, 50, 152, 86, 156, 61, 132, 206, 24, 211, 15, 40,
                                   175, 5, 171, 255, 48, 47, 127, 33, 72, 34, 129, 212, 156, 118,
                                   0, 65, 4, 46, 70, 170, 197, 186, 17, 239, 24, 102, 125, 74, 197,
                                   135, 5, 203, 94, 153, 1, 148, 113, 136, 131, 10, 155, 220, 9,
                                   102, 159, 172, 156, 33, 79, 211, 57, 8, 185, 232, 59, 184, 177,
                                   251, 136, 203, 236, 152, 238, 194, 185, 9, 21, 224, 174, 158,
                                   192, 31, 191, 24, 254, 84, 188, 106, 158, 214, 48 };

    unsigned char *_res;
    unsigned int res_len;

    env_create_info_chunk(p1, p2, sizeof(p2), p3, sizeof(p3), &_res, &res_len);

    if(res_len != sizeof(res))
    {
        env_logWrite(LOG_TYPE_ERROR, "Create info test failed: res_len != sizeof(res)", 0);
        env_logWrite(LOG_TYPE_ERROR, "%u vs %u", 2, res_len, sizeof(res));

        return 1;
    }

    for(i = 0; i < res_len; ++i)
    {
        if(res[i] == _res[i])
        {
            continue;
        }

        env_logWrite(LOG_TYPE_ERROR, "Create info test failed: mismatch at index %u: %hhu vs %hhu",
                                                                                    3, i, res[i], _res[i]);
    }

    if(memcmp(_res, res, res_len))
    {
        env_logWrite(LOG_TYPE_ERROR, "Create info test failed: memcmp", 0);

        return 1;
    }

    free(_res);

    return 0;
}

static int aes_gcm_test()
{
    unsigned char CEK[] = { 54, 202, 112, 209, 92, 21, 8, 144, 251, 61, 40, 62, 46, 23, 197, 192 };
    unsigned char Nonce[] = { 21, 249, 212, 167, 129, 96, 215, 9, 44, 165, 151, 40 };
    unsigned char Input[] = { 0, 0, 72, 101, 108, 108, 111, 32, 87, 111, 114, 108, 100 };
    unsigned char res[] = { 200, 137, 167, 64, 32, 23, 159, 125, 184, 241, 161, 48, 102,
                            164, 215, 35, 246, 227, 199, 220, 241, 231, 20, 32, 146, 17,
                            68, 17, 176 };

    unsigned char *_res;
    unsigned int res_len;

    if(env_aes_gcm_128_encrypt(Input, sizeof(Input), CEK, Nonce, &_res, &res_len))
    {
        env_logWrite(LOG_TYPE_ERROR, "env_aes_gcm_128_encrypt failed", 0);

        return 1;
    }

    if(res_len != sizeof(res))
    {
        env_logWrite(LOG_TYPE_ERROR, "aes_gcm_test failed: res_len error", 0);
        env_logWrite(LOG_TYPE_ERROR, "%u != %u", 2, res_len, sizeof(res));

        return 1;
    }

    if(memcmp(_res, res, res_len))
    {
        env_logWrite(LOG_TYPE_ERROR, "aes_gcm_test test failed: memcmp", 0);

        return 1;
    }

    free(_res);

    return 0;
}



static int aes_gcm_test_big()
{
    unsigned char CEK[] = { 122, 205, 87, 151, 173, 150, 80, 100, 204, 224, 109, 81, 121, 167, 21, 158 };
    unsigned char Nonce[] = { 142, 255, 108, 171, 130, 240, 148, 171, 213, 223, 85, 181 };
    unsigned char Input[] = {   0,0,255,216,255,225,12,22,69,120,105,102,0,0,77,77,0,42,0,0,0,8,0,
                                12,1,0,0,3,0,0,0,1,9,90,0,0,1,1,0,3,0,0,0,
                                1,9,90,0,0,1,2,0,3,0,0,0,3,0,0,0,158,1,6,0,
                                3,0,0,0,1,0,2,0,0,1,18,0,3,0,0,0,1,0,1,0,
                                0,1,21,0,3,0,0,0,1,0,3,0,0,1,26,0,5,0,0,0,
                                1,0,0,0,164,1,27,0,5,0,0,0,1,0,0,0,172,1,40,0,
                                3,0,0,0,1,0,2,0,0,1,49,0,2,0,0,0,29,0,0,0,
                                180,1,50,0,2,0,0,0,20,0,0,0,209,135,105,0,4,0,0,0,
                                1,0,0,0,232,0,0,1,32,0,8,0,8,0,8,0,10,252,218,0,
                                0,39,16,0,10,252,218,0,0,39,16,65,100,111,98,101,32,80,104,111,
                                116,111,115,104,111,112,32,67,67,32,40,87,105,110,100,111,119,115,41,0,
                                50,48,49,53,58,48,57,58,51,48,32,48,57,58,49,54,58,51,57,0,
                                0,0,0,0,4,144,0,0,7,0,0,0,4,48,50,50,49,160,1,0,
                                3,0,0,0,1,255,255,0,0,160,2,0,4,0,0,0,1,0,0,5,
                                220,160,3,0,4,0,0,0,1,0,0,5,220,0,0,0,0,0,0,0,
                                6,1,3,0,3,0,0,0,1,0,6,0,0,1,26,0,5,0,0,0,
                                1,0,0,1,110,1,27,0,5,0,0,0,1,0,0,1,118,1,40,0,
                                3,0,0,0,1,0,2,0,0,2,1,0,4,0,0,0,1,0,0,1,
                                126,2,2,0,4,0,0,0,1,0,0,10,144,0,0,0,0,0,0,0,
                                72,0,0,0,1,0,0,0,72,0,0,0,1,255,216,255,237,0,12,65,
                                100,111,98,101,95,67,77,0,2,255,238,0,14,65,100,111,98,101,0,100,
                                128,0,0,0,1,255,219,0,132,0,12,8,8,8,9,8,12,9,9,12,
                                17,11,10,11,17,21,15,12,12,15,21,24,19,19,21,19,19,24,17,12,
                                12,12,12,12,12,17,12,12,12,12,12,12,12,12,12,12,12,12,12,12,
                                12,12,12,12,12,12,12,12,12,12,12,12,12,12,1,13,11,11,13,14,
                                13,16,14,14,16,20,14,14,14,20,20,14,14,14,14,20,17,12,12,12,
                                12,12,17,17,12,12,12,12,12,12,17,12,12,12,12,12,12,12,12,12,
                                12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,255,
                                192,0,17,8,0,160,0,160,3,1,34,0,2,17,1,3,17,1,255,221,
                                0,4,0,10,255,196,1,63,0,0,1,5,1,1,1,1,1,1,0,0,
                                0,0,0,0,0,3,0,1,2,4,5,6,7,8,9,10,11,1,0,1,
                                5,1,1,1,1,1,1,0,0,0,0,0,0,0,1,0,2,3,4,5,
                                6,7,8,9,10,11,16,0,1,4,1,3,2,4,2,5,7,6,8,5,
                                3,12,51,1,0,2,17,3,4,33,18,49,5,65,81,97,19,34,113,129,
                                50,6,20,145,161,177,66,35,36,21,82,193,98,51,52,114,130,209,67,7,
                                37,146,83,240,225,241,99,115,53,22,162,178,131,38,68,147,84,100,69,194,
                                163,116,54,23,210,85,226,101,242,179,132,195,211,117,227,243,70,39,148,164,
                                133,180,149,196,212,228,244,165,181,197,213,229,245,86,102,118,134,150,166,182,
                                198,214,230,246,55,71,87,103,119,135,151,167,183,199,215,231,247,17,0,2,
                                2,1,2,4,4,3,4,5,6,7,7,6,5,53,1,0,2,17,3,33,
                                49,18,4,65,81,97,113,34,19,5,50,129,145,20,161,177,66,35,193,82,
                                209,240,51,36,98,225,114,130,146,67,83,21,99,115,52,241,37,6,22,162,
                                178,131,7,38,53,194,210,68,147,84,163,23,100,69,85,54,116,101,226,242,
                                179,132,195,211,117,227,243,70,148,164,133,180,149,196,212,228,244,165,181,197,
                                213,229,245,86,102,118,134,150,166,182,198,214,230,246,39,55,71,87,103,119,
                                135,151,167,183,199,255,218,0,12,3,1,0,2,17,3,17,0,63,0,227,
                                218,173,208,170,55,149,110,148,242,188,183,26,136,2,19,17,154,19,74,23,
                                133,54,181,59,89,40,172,98,106,64,98,214,34,53,136,141,173,16,49,11,
                                77,35,12,83,107,17,69,106,109,98,105,43,128,66,43,81,251,61,142,176,
                                22,177,206,243,0,159,200,173,10,214,213,88,149,181,141,110,216,208,76,18,
                                36,199,145,76,76,141,57,44,197,180,143,230,221,247,20,190,205,111,238,59,
                                238,43,92,227,180,112,94,63,180,229,23,84,225,16,247,243,251,201,44,183,
                                39,208,183,247,29,247,40,186,155,27,203,72,249,45,83,91,191,125,223,120,
                                254,228,50,219,7,231,187,240,254,228,180,85,185,133,132,118,81,33,105,147,
                                96,255,0,8,239,185,191,249,21,19,234,31,240,135,230,214,159,251,234,73,
                                183,48,168,21,164,230,90,127,194,54,60,234,97,66,125,14,60,185,191,42,
                                154,16,209,54,255,0,255,208,227,235,10,221,32,147,162,142,62,43,221,19,
                                162,210,163,29,140,141,36,169,41,38,65,84,210,226,174,87,72,26,66,122,
                                235,42,205,117,132,211,72,4,181,173,107,107,41,82,224,242,155,168,232,230,
                                128,163,135,244,147,11,32,26,55,154,196,70,177,73,141,69,107,19,74,67,
                                0,197,54,177,16,49,77,140,213,48,174,138,213,85,186,198,183,247,136,31,
                                121,91,155,53,43,63,18,185,200,171,250,192,253,218,173,112,196,196,100,232,
                                215,44,67,123,53,10,217,98,27,153,168,69,141,170,230,33,57,138,219,152,
                                134,230,162,166,147,216,132,173,189,136,15,106,73,70,160,224,166,162,238,19,
                                74,224,255,0,255,209,203,173,158,26,43,85,87,8,53,181,197,91,170,183,
                                21,33,43,64,74,198,74,59,27,180,38,169,155,121,82,181,193,172,37,69,
                                34,201,16,229,103,59,117,241,224,143,130,201,116,170,101,251,238,115,188,214,
                                158,3,68,32,89,27,204,106,43,90,147,27,162,43,90,154,84,22,13,68,
                                99,117,78,214,162,177,169,146,92,19,224,87,57,0,254,232,39,248,45,77,
                                170,159,78,103,189,231,193,160,125,229,95,132,192,183,38,232,139,80,220,221,
                                66,176,66,27,135,185,21,136,28,212,39,53,89,112,66,112,69,20,213,123,
                                85,119,181,92,120,85,222,18,75,81,194,10,27,184,71,176,32,57,34,144,
                                255,0,255,210,167,69,118,159,130,187,83,30,53,77,88,128,140,211,162,82,
                                149,164,6,64,199,42,182,125,237,109,68,78,168,151,222,43,97,61,251,44,
                                92,140,131,99,249,248,32,7,85,227,118,116,234,229,181,130,216,106,198,198,
                                26,133,189,136,216,96,64,174,45,198,4,86,133,6,35,52,38,21,6,77,
                                8,172,10,45,8,172,26,166,73,120,111,244,246,251,30,124,72,252,2,183,
                                8,56,109,219,67,127,148,73,86,19,66,201,238,88,16,132,71,185,28,161,
                                17,170,43,81,184,33,60,35,57,9,233,41,174,240,171,188,43,47,85,236,
                                74,212,214,176,42,182,114,173,88,170,91,162,75,128,127,255,211,76,41,89,
                                104,172,73,64,55,181,131,83,202,161,153,153,50,231,29,18,17,181,215,217,
                                108,236,221,196,235,162,167,83,203,157,184,170,118,100,155,95,228,172,208,120,
                                78,43,226,40,58,152,188,133,191,139,244,66,231,177,15,184,46,135,20,251,
                                66,142,73,110,86,172,53,87,173,88,98,97,72,74,208,138,192,134,192,140,
                                196,201,46,14,158,48,253,11,35,93,17,86,88,123,153,171,76,40,191,170,
                                221,91,195,72,220,60,103,253,137,182,16,96,75,168,80,207,40,12,204,123,
                                196,192,79,235,187,247,71,222,151,213,109,22,110,66,122,32,245,92,55,10,
                                244,237,168,19,247,161,189,183,127,163,63,120,70,138,52,64,245,94,194,141,
                                104,185,162,77,78,142,241,7,248,170,86,90,239,220,119,225,253,233,82,67,
                                11,21,75,145,45,189,218,254,137,223,120,10,157,183,220,102,42,3,226,255,
                                0,252,136,74,188,190,212,135,255,212,231,236,189,196,145,51,28,42,182,209,
                                145,146,64,224,121,43,152,120,55,88,1,45,208,248,173,188,94,153,17,41,
                                230,64,46,26,108,224,99,244,87,144,57,90,88,253,5,218,76,174,134,156,
                                58,219,192,86,217,91,71,100,195,53,214,94,117,253,42,204,120,123,68,129,
                                217,94,195,176,22,129,221,107,186,166,189,187,72,88,249,84,59,22,237,205,
                                250,36,234,152,77,174,26,186,85,43,53,170,56,214,135,52,43,140,114,105,
                                74,118,148,102,42,237,114,61,101,48,174,12,220,179,242,79,233,71,197,94,
                                113,89,185,78,253,40,248,168,229,178,240,234,99,106,197,127,31,28,16,30,
                                241,167,230,183,248,149,79,166,215,234,13,199,232,55,159,51,224,180,203,145,
                                136,97,153,232,22,113,66,113,83,113,66,113,82,49,163,113,84,114,168,4,
                                23,176,107,221,190,42,227,220,171,216,228,14,169,4,131,163,143,104,85,44,
                                11,71,45,160,29,195,191,63,21,159,111,116,198,80,109,255,213,150,43,67,
                                107,26,66,189,90,169,89,16,172,214,228,194,119,94,27,117,163,14,21,106,
                                220,142,12,132,58,43,170,70,185,67,46,134,223,81,4,106,152,57,21,174,
                                209,5,206,37,15,117,23,26,157,219,143,130,210,101,146,22,103,87,30,157,
                                205,176,105,170,54,46,70,246,4,151,120,186,141,122,177,91,150,125,101,199,
                                128,74,183,83,108,240,77,144,72,41,156,229,149,153,100,90,62,43,91,211,
                                113,26,161,125,138,183,90,199,56,76,56,31,185,70,69,174,226,14,174,27,
                                61,28,102,87,249,192,75,190,39,148,98,245,88,88,145,177,16,196,117,74,
                                231,161,57,234,14,126,136,47,181,20,83,55,189,86,178,196,214,90,170,91,
                                114,90,166,149,125,128,130,22,109,206,213,26,235,85,43,95,170,4,46,15,
                                255,214,141,118,43,85,216,179,25,103,10,213,78,113,224,38,144,188,58,44,
                                126,161,89,99,180,84,107,14,49,42,221,77,37,52,148,178,221,172,35,87,
                                184,246,79,93,35,186,178,198,52,118,77,180,185,249,61,47,237,103,222,72,
                                30,90,43,24,189,34,138,64,13,10,243,64,68,1,11,41,180,108,198,99,
                                120,8,162,176,19,132,233,186,170,215,13,103,130,103,181,187,73,9,18,134,
                                231,128,146,150,220,162,94,162,92,10,129,114,65,12,223,110,144,128,251,18,
                                115,144,94,81,83,27,30,169,218,244,107,28,170,218,66,42,107,218,242,84,
                                3,43,35,244,142,218,127,52,119,42,78,58,162,87,96,99,123,79,138,69,
                                65,255,215,29,117,177,188,8,71,106,11,74,43,28,152,87,183,41,30,42,
                                229,100,5,66,183,163,122,237,96,5,238,13,147,2,76,106,152,87,55,93,
                                125,117,86,235,109,120,174,186,198,231,189,198,26,0,238,226,176,109,250,243,
                                75,46,115,113,241,13,212,141,27,99,159,176,187,249,94,158,199,237,106,7,
                                87,233,189,91,170,217,7,47,26,188,86,25,171,30,95,207,250,75,189,191,
                                164,183,254,133,106,136,250,161,212,207,25,24,199,251,79,255,0,210,105,241,
                                140,127,73,78,179,126,190,180,115,128,126,87,127,234,36,86,125,126,160,144,
                                63,103,218,92,226,3,90,219,90,73,39,70,181,173,244,253,206,114,197,31,
                                83,122,191,107,177,143,246,223,255,0,164,214,223,213,239,171,205,233,175,251,
                                69,238,109,221,67,80,199,55,90,233,105,210,106,221,183,117,238,255,0,75,
                                254,15,252,26,82,246,192,218,212,244,152,249,22,216,198,122,181,26,45,115,
                                119,89,73,112,121,172,254,227,222,192,27,234,126,246,212,109,202,189,101,172,
                                110,214,252,207,138,158,245,18,139,39,184,194,5,142,116,24,229,20,184,20,
                                55,6,148,149,109,23,100,93,89,38,55,127,39,251,144,221,213,241,89,165,
                                206,52,159,248,64,64,255,0,63,249,191,250,74,243,216,216,215,95,138,3,
                                168,97,236,142,136,213,8,234,88,150,125,11,235,127,245,94,211,249,28,160,
                                252,186,191,120,71,196,38,187,165,225,216,101,244,86,227,226,230,180,254,80,
                                171,59,162,116,222,126,203,87,249,141,255,0,200,163,81,238,85,171,12,142,
                                169,135,95,211,190,166,252,94,209,255,0,126,89,246,245,204,103,105,64,126,
                                73,240,169,132,143,251,117,219,42,255,0,193,22,147,122,94,35,15,178,150,
                                51,224,208,63,234,66,159,216,235,31,154,17,244,142,234,213,200,166,220,188,
                                131,47,175,211,29,152,14,227,253,167,125,21,122,182,56,13,121,86,133,0,
                                39,244,192,64,144,144,255,0,255,208,168,215,184,119,33,21,151,31,34,185,
                                154,237,186,175,230,222,230,124,14,159,230,253,21,106,190,169,148,207,165,182,
                                193,230,32,253,236,133,33,128,70,189,11,209,179,32,15,37,11,169,25,100,
                                7,216,54,130,8,111,28,44,154,186,205,71,75,43,115,60,218,67,135,253,
                                245,91,171,168,97,217,244,109,108,248,59,218,127,233,38,112,86,161,60,71,
                                168,116,219,134,71,238,31,146,43,113,29,252,143,245,249,42,53,220,121,107,
                                180,242,50,142,204,187,7,121,248,166,145,47,4,130,60,67,105,184,132,157,
                                75,71,193,95,164,182,182,6,14,221,207,117,152,204,223,222,31,114,51,50,
                                235,61,227,226,163,144,151,80,184,17,208,186,34,208,165,234,170,35,33,167,
                                130,18,251,71,130,109,46,111,27,64,81,55,120,42,126,172,247,72,89,41,
                                82,155,70,201,76,95,8,30,162,98,242,146,18,186,196,50,233,81,148,210,
                                146,151,148,196,166,37,10,220,138,171,18,247,6,132,169,73,9,81,115,128,
                                18,116,30,43,55,35,172,49,186,82,221,199,247,142,129,101,228,230,223,116,
                                250,143,49,251,163,64,164,142,41,29,244,65,152,30,47,255,217,255,237,19,
                                236,80,104,111,116,111,115,104,111,112,32,51,46,48,0,56,66,73,77,4,
                                4,0,0,0,0,0,15,28,1,90,0,3,27,37,71,28,2,0,0,2,
                                236,224,0,56,66,73,77,4,37,0,0,0,0,0,16,128,79,145,119,72,
                                116,47,121,40,27,95,99,213,237,17,18,56,66,73,77,4,58,0,0,0,
                                0,0,229,0,0,0,16,0,0,0,1,0,0,0,0,0,11,112,114,105,
                                110,116,79,117,116,112,117,116,0,0,0,5,0,0,0,0,80,115,116,83,
                                98,111,111,108,1,0,0,0,0,73,110,116,101,101,110,117,109,0,0,0,
                                0,73,110,116,101,0,0,0,0,67,108,114,109,0,0,0,15,112,114,105,
                                110,116,83,105,120,116,101,101,110,66,105,116,98,111,111,108,0,0,0,0,
                                11,112,114,105,110,116,101,114,78,97,109,101,84,69,88,84,0,0,0,1,
                                0,0,0,0,0,15,112,114,105,110,116,80,114,111,111,102,83,101,116,117,
                                112,79,98,106,99,0,0,0,12,0,80,0,114,0,111,0,111,0,102,0,
                                32,0,83,0,101,0,116,0,117,0,112,0,0,0,0,0,10,112,114,111,
                                111,102,83,101,116,117,112,0,0,0,1,0,0,0,0,66,108,116,110,101,
                                110,117,109,0,0,0,12,98,117,105,108,116,105,110,80,114,111,111,102,0,
                                0,0,9,112,114,111,111,102,67,77,89,75,0,56,66,73,77,4,59,0,
                                0,0,0,2,45,0,0,0,16,0,0,0,1,0,0,0,0,0,18,112,
                                114,105,110,116,79,117,116,112,117,116,79,112,116,105,111,110,115,0,0,0,
                                23,0,0,0,0,67,112,116,110,98,111,111,108,0,0,0,0,0,67,108,
                                98,114,98,111,111,108,0,0,0,0,0,82,103,115,77,98,111,111,108,0,
                                0,0,0,0,67,114,110,67,98,111,111,108,0,0,0,0,0,67,110,116,
                                67,98,111,111,108,0,0,0,0,0,76,98,108,115,98,111,111,108,0,0,
                                0,0,0,78,103,116,118,98,111,111,108,0,0,0,0,0,69,109,108,68,
                                98,111,111,108,0,0,0,0,0,73,110,116,114,98,111,111,108,0,0,0,
                                0,0,66,99,107,103,79,98,106,99,0,0,0,1,0,0,0,0,0,0,
                                82,71,66,67,0,0,0,3,0,0,0,0,82,100,32,32,100,111,117,98,
                                64,111,224,0,0,0,0,0,0,0,0,0,71,114,110,32,100,111,117,98,
                                64,111,224,0,0,0,0,0,0,0,0,0,66,108,32,32,100,111,117,98,
                                64,111,224,0,0,0,0,0,0,0,0,0,66,114,100,84,85,110,116,70,
                                35,82,108,116,0,0,0,0,0,0,0,0,0,0,0,0,66,108,100,32,
                                85,110,116,70,35,82,108,116,0,0,0,0,0,0,0,0,0,0,0,0,
                                82,115,108,116,85,110,116,70,35,80,120,108,64,82,0,147,128,0,0,0,
                                0,0,0,10,118,101,99,116,111,114,68,97,116,97,98,111,111,108,1,0,
                                0,0,0,80,103,80,115,101,110,117,109,0,0,0,0,80,103,80,115,0,
                                0,0,0,80,103,80,67,0,0,0,0,76,101,102,116,85,110,116,70,35,
                                82,108,116,0,0,0,0,0,0,0,0,0,0,0,0,84,111,112,32,85,
                                110,116,70,35,82,108,116,0,0,0,0,0,0,0,0,0,0,0,0,83,
                                99,108,32,85,110,116,70,35,80,114,99,64,89,0,0,0,0,0,0,0,
                                0,0,16,99,114,111,112,87,104,101,110,80,114,105,110,116,105,110,103,98,
                                111,111,108,0,0,0,0,14,99,114,111,112,82,101,99,116,66,111,116,116,
                                111,109,108,111,110,103,0,0,0,0,0,0,0,12,99,114,111,112,82,101,
                                99,116,76,101,102,116,108,111,110,103,0,0,0,0,0,0,0,13,99,114,
                                111,112,82,101,99,116,82,105,103,104,116,108,111,110,103,0,0,0,0,0,
                                0,0,11,99,114,111,112,82,101,99,116,84,111,112,108,111,110,103,0,0,
                                0,0,0,56,66,73,77,3,237,0,0,0,0,0,16,0,72,2,78 };
    unsigned char res[] = { 3,68,246,202,50,236,99,113,129,253,27,232,201,80,232,144,101,95,150,232,37,
                            169,83,88,58,211,38,145,26,223,65,240,15,250,178,44,210,250,86,132,81,
                            58,217,193,193,101,142,248,203,71,229,139,222,153,12,80,167,107,79,232,207,
                            231,148,208,199,181,190,24,196,143,189,139,204,182,253,251,169,156,236,43,34,
                            139,243,83,178,112,28,52,250,97,111,190,226,142,87,124,16,209,64,123,124,
                            29,57,229,55,213,190,221,75,118,227,13,89,229,63,150,252,17,144,0,168,
                            157,15,146,143,131,142,223,184,45,7,52,65,7,28,54,146,11,145,210,230,
                            209,73,123,86,67,32,37,40,201,31,217,216,221,162,116,234,199,250,120,168,
                            106,22,6,112,43,215,223,141,6,92,132,139,204,230,126,43,190,89,249,7,
                            86,142,246,88,59,3,44,93,163,146,10,143,36,54,112,131,199,204,45,123,
                            0,108,174,242,198,192,214,16,42,229,105,219,152,199,221,99,151,191,209,28,
                            126,148,56,220,0,19,32,211,143,129,31,100,67,172,233,2,137,121,186,21,
                            195,108,131,232,76,89,55,100,54,216,65,243,13,95,169,216,183,96,188,3,
                            54,36,31,196,39,73,70,117,111,187,80,72,123,147,172,173,0,198,170,147,
                            89,47,165,57,86,180,248,75,40,6,212,223,75,88,157,152,0,125,36,198,
                            246,219,168,85,234,69,66,9,213,252,118,152,250,232,21,59,4,48,43,130,
                            170,60,110,158,75,167,39,75,90,255,60,233,194,86,102,193,49,43,174,70,
                            196,99,254,9,53,15,215,132,207,47,249,65,29,225,203,0,34,150,159,125,
                            175,163,60,8,124,148,38,78,62,64,39,28,37,123,167,178,200,88,253,197,
                            3,167,249,17,201,33,228,105,210,209,170,111,65,240,139,175,179,38,82,179,
                            246,203,118,171,85,156,170,129,88,227,144,102,35,121,170,210,218,217,239,185,
                            236,31,212,53,161,90,156,127,230,196,248,5,53,203,14,240,80,89,139,32,
                            171,246,237,247,61,189,182,144,38,22,8,96,113,204,133,189,225,47,247,113,
                            127,241,162,146,54,6,204,12,225,191,142,97,126,199,47,49,217,188,179,10,
                            229,17,42,69,142,199,123,142,6,230,68,34,24,58,48,81,229,182,234,90,
                            25,189,1,195,46,245,73,211,123,151,205,194,15,101,120,44,208,180,60,222,
                            114,192,170,137,208,187,71,178,98,201,199,89,240,195,181,219,153,59,111,145,
                            242,5,87,214,214,238,41,225,161,39,238,117,7,86,48,6,106,27,97,114,
                            71,236,174,70,88,164,189,122,169,23,208,118,23,212,173,238,72,3,81,182,
                            140,25,117,63,33,156,237,144,211,66,24,206,143,36,107,87,244,24,243,89,
                            181,13,228,68,127,188,200,159,113,174,92,191,156,92,155,156,44,132,186,62,
                            175,6,225,217,137,142,141,198,177,8,33,176,105,89,34,92,10,183,179,226,
                            23,246,180,151,10,243,124,25,55,231,188,205,217,98,25,193,255,233,20,186,
                            217,44,79,61,44,242,10,47,82,134,197,90,159,65,93,213,63,26,15,223,
                            138,80,225,20,72,212,168,244,213,123,47,143,124,118,225,229,78,204,230,244,
                            185,29,247,168,118,229,41,205,254,173,16,241,91,96,252,107,101,194,43,170,
                            88,212,129,52,224,5,3,249,132,111,67,86,151,178,132,42,51,239,184,84,
                            66,79,209,217,43,167,219,113,172,197,77,156,181,170,68,9,77,87,218,131,
                            195,57,108,187,199,6,41,45,4,32,255,70,245,246,180,141,4,211,6,46,
                            151,10,101,138,81,21,27,143,124,27,25,31,100,253,47,74,102,103,125,45,
                            221,130,106,142,68,66,116,1,24,20,33,251,224,127,48,192,140,41,213,124,
                            210,50,160,202,90,148,79,242,172,34,218,124,14,40,70,182,90,254,44,96,
                            57,55,143,59,84,19,112,158,164,167,236,209,178,136,234,102,227,156,38,47,
                            162,146,84,16,55,249,41,53,222,186,134,19,174,91,173,200,185,78,185,220,
                            13,141,10,116,141,8,42,23,88,22,143,217,105,126,154,99,4,33,10,149,
                            131,108,144,166,253,100,25,157,166,144,164,106,164,237,136,221,244,182,172,8,
                            203,125,139,87,105,38,105,29,149,241,81,247,86,225,237,10,131,160,169,40,
                            42,248,68,254,220,189,215,87,183,249,249,12,18,177,41,197,32,195,142,180,
                            104,184,6,42,58,1,5,160,198,189,195,166,172,202,19,218,173,173,249,189,
                            111,47,191,218,56,227,61,47,245,100,89,65,47,21,124,168,242,8,255,228,
                            86,220,108,155,93,253,84,90,127,156,133,155,138,136,158,217,163,207,166,225,
                            37,1,139,174,246,96,253,218,221,181,131,193,205,62,128,39,228,178,45,253,
                            145,105,180,103,12,38,107,109,23,208,250,57,56,170,238,69,74,220,97,86,
                            10,174,18,70,52,223,59,244,13,174,6,105,118,28,254,217,224,65,148,255,
                            54,18,102,68,37,187,109,20,229,23,118,41,197,110,200,37,176,64,219,251,
                            56,141,100,45,99,21,137,38,55,114,76,215,15,194,204,246,64,31,207,95,
                            191,143,45,97,249,199,86,160,212,145,24,98,0,134,57,199,176,97,174,236,
                            221,25,167,167,243,197,212,109,223,176,217,99,171,138,80,134,161,195,254,105,
                            196,3,25,93,132,168,44,8,193,148,235,198,230,20,33,5,181,53,113,7,
                            116,227,120,42,212,4,40,64,194,110,63,223,147,216,67,201,101,31,124,228,
                            193,149,177,21,178,148,142,58,221,32,249,186,253,204,254,3,24,180,58,220,
                            197,116,127,66,144,61,166,243,15,23,234,228,235,53,99,82,234,210,29,91,
                            215,23,178,161,169,153,64,244,63,9,239,165,81,54,27,27,180,157,58,60,
                            86,142,161,173,162,117,143,5,77,254,64,57,72,220,95,116,223,85,56,97,
                            234,64,109,78,75,44,148,155,160,29,205,118,109,124,252,214,200,141,146,186,
                            73,51,11,229,238,246,51,128,226,1,66,244,245,213,101,29,15,32,174,214,
                            221,172,111,115,46,84,48,68,223,234,8,230,227,102,212,193,79,26,220,208,
                            49,135,55,134,188,2,3,33,224,40,26,166,63,235,253,0,252,208,89,129,
                            82,104,148,179,229,40,112,70,143,118,179,90,242,58,21,105,153,98,201,151,
                            206,46,127,58,83,89,36,85,227,172,225,149,50,218,155,53,192,90,4,193,
                            190,37,199,91,120,101,117,106,33,187,188,203,30,23,105,38,201,123,236,254,
                            144,64,241,33,36,154,247,57,32,191,59,150,64,140,42,143,128,61,101,67,
                            146,151,140,222,159,38,93,128,44,212,53,133,247,121,62,128,145,217,146,231,
                            87,240,68,91,8,34,237,198,54,139,46,58,207,226,160,164,157,215,29,75,
                            72,204,117,51,113,229,67,209,4,154,82,229,153,225,232,226,199,199,56,80,
                            206,251,236,160,68,74,236,20,241,154,171,0,36,21,17,255,102,58,82,56,
                            247,195,36,10,38,124,88,36,76,187,76,238,5,48,192,196,35,168,15,155,
                            158,208,128,184,131,166,40,104,20,122,249,36,149,230,116,86,249,23,170,189,
                            124,97,232,47,11,1,238,229,188,173,23,168,52,142,0,82,242,190,104,65,
                            160,81,64,213,119,139,3,85,196,157,96,188,246,70,61,244,146,101,190,22,
                            27,63,235,172,37,31,25,211,194,46,230,57,145,167,134,135,238,12,220,52,
                            225,26,159,224,204,78,76,38,242,50,78,161,100,184,129,155,97,133,254,188,
                            46,209,228,81,82,92,56,90,192,118,130,231,248,217,85,18,7,81,245,252,
                            237,35,26,68,232,135,147,126,151,113,102,41,242,206,42,225,221,154,16,152,
                            96,58,212,105,131,70,154,13,175,234,163,146,245,235,91,4,7,50,179,71,
                            204,205,24,162,164,31,241,243,110,145,183,110,161,137,163,150,207,226,22,224,
                            215,8,29,143,252,60,227,38,93,233,2,157,231,171,105,145,211,213,72,82,
                            208,29,13,138,207,123,43,13,155,67,182,79,137,194,179,80,19,99,50,32,
                            93,238,132,72,220,193,177,241,85,210,157,167,105,164,111,150,139,164,127,217,
                            180,157,246,143,250,211,248,93,56,28,126,223,45,149,36,52,223,2,81,213,
                            90,86,200,170,123,27,190,87,61,121,65,1,171,60,11,211,252,244,146,190,
                            238,212,105,56,136,20,49,77,32,130,101,164,146,148,205,232,151,104,96,79,
                            153,46,230,121,106,108,127,34,23,241,254,169,77,157,143,212,34,187,122,149,
                            71,6,99,91,225,230,171,66,240,80,27,219,179,170,73,119,213,167,206,21,
                            91,83,151,135,66,90,121,83,141,176,47,152,221,172,194,124,71,192,1,212,
                            15,80,38,128,40,254,52,187,113,52,13,175,225,219,9,50,202,58,32,39,
                            218,18,34,81,251,203,255,87,81,110,89,6,10,102,44,80,195,235,19,49,
                            84,214,104,117,89,28,190,220,15,12,233,84,137,151,212,128,71,160,200,15,
                            30,121,77,215,86,4,183,183,251,0,236,228,222,68,36,210,190,10,33,180,
                            240,62,190,10,134,3,180,14,250,14,48,111,3,195,53,173,123,233,197,165,
                            67,36,234,93,177,75,20,160,72,67,153,124,8,38,127,252,143,53,15,22,
                            211,29,119,113,121,89,69,54,102,228,107,172,83,26,18,191,130,123,207,78,
                            211,138,44,202,161,13,27,255,53,10,134,3,201,41,201,57,3,85,246,145,
                            197,155,145,16,128,175,198,112,196,97,206,210,119,195,230,251,173,3,164,187,
                            26,109,83,134,254,109,201,89,189,27,110,102,32,222,244,3,199,86,23,68,
                            100,36,240,184,132,6,113,86,237,53,164,93,1,135,218,73,203,102,27,162,
                            61,68,125,190,219,247,28,234,97,143,36,126,98,133,184,214,170,113,59,32,
                            14,1,31,1,157,9,103,164,39,130,99,212,197,42,48,21,252,193,101,98,
                            115,46,46,121,1,66,65,18,2,136,229,33,153,71,4,50,100,105,121,42,
                            250,11,0,17,245,229,231,116,111,26,160,117,82,172,92,207,21,48,125,33,
                            212,95,237,130,50,178,50,96,49,176,84,225,110,255,92,52,214,183,170,33,
                            187,125,146,139,2,162,180,35,25,62,207,90,23,77,210,215,18,187,246,142,
                            91,103,235,240,52,233,138,173,196,245,0,26,6,71,250,41,208,48,252,255,
                            134,118,135,254,177,149,166,171,119,194,249,227,80,189,75,86,129,113,164,90,
                            230,226,242,202,143,35,243,247,2,106,49,31,145,189,86,122,242,34,84,43,
                            88,62,178,250,242,55,108,132,168,219,28,25,169,4,220,33,2,3,115,232,
                            114,150,73,244,13,49,245,40,98,194,187,2,43,208,163,163,56,141,169,140,
                            194,203,240,17,120,68,109,144,170,31,53,38,166,194,199,179,37,204,169,71,
                            187,178,36,207,207,29,49,174,152,38,24,131,65,76,230,12,122,100,228,105,
                            114,155,149,32,72,26,124,56,34,2,233,69,224,130,82,83,18,190,123,4,
                            180,79,79,38,136,135,168,85,32,116,116,215,44,160,255,23,41,205,123,97,
                            54,185,252,66,211,119,186,158,113,35,252,161,180,51,45,87,73,243,191,90,
                            59,176,27,141,56,112,150,199,17,154,163,30,87,218,63,6,164,9,29,7,
                            94,82,52,188,181,118,180,45,96,141,126,162,9,203,196,97,73,80,240,191,
                            170,133,177,54,24,46,134,239,216,236,114,35,15,71,63,62,123,134,219,18,
                            114,246,89,188,63,244,39,239,33,216,132,57,206,6,219,1,47,109,131,84,
                            241,7,219,178,191,141,143,36,29,194,148,195,27,20,124,90,53,244,233,107,
                            119,241,53,108,63,164,52,112,227,249,117,76,223,49,175,11,20,235,193,95,
                            115,184,77,209,23,125,240,52,98,236,67,104,114,104,226,229,13,241,214,250,
                            18,172,176,124,139,176,6,136,43,60,207,88,106,185,100,219,135,237,87,170,
                            210,111,91,245,90,26,102,103,254,34,28,65,2,193,26,177,131,108,187,106,
                            2,27,189,140,21,99,243,84,118,92,236,111,65,9,129,35,181,130,253,179,
                            108,183,209,95,22,247,226,178,54,239,46,195,70,59,151,217,189,151,213,76,
                            221,45,19,131,163,33,59,201,39,12,53,41,208,51,217,156,67,169,172,174,
                            44,127,204,148,198,89,78,255,93,25,71,62,194,61,153,180,219,52,252,117,
                            153,116,82,71,128,43,201,133,47,207,46,209,130,85,109,13,40,161,167,115,
                            7,37,11,159,90,208,8,93,24,75,180,143,68,204,228,24,171,98,68,255,
                            66,79,165,33,238,67,165,126,156,197,74,57,227,254,70,110,245,118,138,71,
                            19,23,219,14,147,1,75,74,215,143,174,99,68,248,17,195,119,84,22,54,
                            170,25,27,35,183,180,223,132,251,185,198,54,114,9,32,84,245,102,174,83,
                            7,98,52,249,147,199,48,2,237,161,200,69,130,119,80,205,192,81,247,150,
                            8,232,20,111,220,251,244,146,230,4,43,174,171,113,180,223,4,134,189,197,
                            108,193,113,80,174,12,16,113,230,51,118,29,8,35,215,131,61,238,80,149,
                            211,75,101,24,73,67,156,79,97,145,178,178,162,70,143,157,204,184,160,232,
                            137,88,181,81,220,29,170,2,126,206,209,43,226,206,117,212,246,194,108,176,
                            34,46,190,133,65,118,133,210,248,98,47,20,198,58,180,0,59,152,5,144,
                            201,219,98,141,0,236,200,48,35,204,66,215,101,10,54,179,182,132,96,65,
                            249,81,127,120,174,87,241,43,46,192,4,188,9,73,46,193,224,179,142,210,
                            83,166,14,192,172,25,246,160,128,148,248,73,93,138,211,23,29,248,195,250,
                            181,137,133,117,123,195,81,123,174,195,82,227,192,163,248,157,6,186,137,75,
                            14,176,79,100,247,254,187,53,128,194,53,123,16,145,247,0,138,53,173,232,
                            23,83,50,155,183,75,17,114,198,9,54,36,170,103,233,38,120,190,179,158,
                            45,226,92,114,8,217,34,214,60,131,62,3,75,86,177,195,124,152,17,36,
                            215,203,177,235,153,71,242,175,100,43,50,113,181,187,154,153,214,128,196,54,
                            3,136,110,115,92,103,24,48,100,203,4,26,81,161,58,228,2,165,68,116,
                            59,60,190,240,0,7,27,220,184,216,204,246,186,110,41,180,23,185,248,244,
                            222,184,161,229,125,206,210,181,46,239,75,236,137,46,143,68,214,143,75,252,
                            82,92,34,175,148,93,133,128,21,208,195,160,80,246,101,77,71,203,154,125,
                            164,22,82,230,160,251,211,65,198,168,209,3,222,118,87,57,235,169,103,102,
                            42,21,187,207,7,177,98,100,27,87,132,201,42,160,93,245,153,32,53,185,
                            193,219,139,71,24,223,131,247,137,207,29,115,179,213,18,66,14,98,160,47,
                            141,234,205,41,205,48,59,223,132,21,183,241,211,15,214,43,254,172,38,90,
                            121,215,15,253,185,189,246,226,19,7,210,149,82,228,80,103,195,166,155,9,
                            132,209,187,20,247,196,85,143,108,96,65,4,159,132,219,42,76,198,62,95,
                            9,168,171,91,4,119,222,43,183,65,254,86,162,77,116,122,97,68,120,89,
                            140,27,48,246,115,99,223,142,205,104,37,137,208,190,72,150,123,122,91,199,
                            23,42,157,86,196,206,169,163,64,62,232,86,98,178,23,206,39,38,165,141,
                            215,53,5,154,156,24,1,35,198,48,111,189,89,28,35,62,211,165,255,112,
                            158,66,118,146,82,238,236,120,95,45,173,50,50,83,50,169,202,69,40,254,
                            70,183,29,88,179,19,195,195,85,169,148,14,102,82,155,187,205,151,110,90,
                            79,32,158,203,30,68,254,222,154,6,241,121,116,59,194,184,181,218,118,85,
                            233,238,124,135,132,139,236,22,154,168,59,184,168,93,214,152,83,156,185,112,
                            100,99,183,146,207,169,210,110,223,99,169,208,113,202,249,12,40,190,16,253,
                            254,162,173,183,74,122,110,228,27,128,108,182,4,182,161,248,228,65,54,200,
                            94,0,214,0,157,78,38,250,51,165,193,254,204,128,110,84,236,192,93,44,
                            110,94,12,129,196,20,88,133,162,232,177,123,225,137,203,88,120,251,25,120,
                            160,12,139,12,118,251,228,123,46,89,10,56,102,120,167,233,96,0,210,147,
                            24,161,0,25,62,193,198,43,43,151,72,47,222,166,177,44,213,91,150,201,
                            180,7,8,247,217,66,129,241,161,207,177,43,132,1,235,220,113,222,195,73,
                            125,84,183,151,139,181,212,36,139,158,145,216,218,250,41,235,60,143,70,133,
                            15,222,28,19,54,245,27,85,88,74,167,121,88,206,37,183,200,229,50,227,
                            130,246,143,9,225,58,248,188,83,192,58,154,141,40,199,197,21,39,241,58,
                            215,1,179,229,71,89,122,186,170,209,96,188,251,101,46,193,240,107,93,229,
                            82,85,10,76,99,230,177,160,206,126,159,150,151,37,47,30,62,195,60,200,
                            131,207,122,108,254,61,176,35,147,31,105,200,228,1,36,66,239,204,128,152,
                            143,15,252,61,211,119,158,220,253,99,33,104,162,225,235,117,51,93,218,196,
                            83,130,176,111,37,72,223,174,147,141,207,193,166,254,127,230,173,149,115,122,
                            24,73,3,254,118,27,0,106,210,114,255,46,158,14,164,213,249,179,54,231,
                            50,31,49,241,125,111,170,134,174,167,88,238,80,145,132,81,201,161,222,83,
                            81,165,8,212,46,167,194,1,177,92,237,100,121,146,237,197,201,246,114,103,
                            227,58,129,181,133,53,224,74,160,5,249,227,239,143,167,209,254,139,98,175,
                            136,114,9,163,127,49,213,47,185,1,118,181,74,126,195,196,235,166,111,132,
                            113,67,56,246,195,47,60,119,200,192,28,3,111,114,16,103,150,27,162,50,
                            155,121,25,27,225,121,102,75,136,19,121,209,24,28,1,214,145,19,138,103,
                            211,97,147,89,113,48,58,144,93,107,132,152,229,180,58,30,190,104,174,33,
                            160,243,40,196,59,214,151,46,116,44,185,40,244,202,230,115,1,50,229,36,
                            81,177,136,116,96,9,117,36,204,159,48,204,192,200,206,153,197,204,204,26,
                            93,56,247,26,143,87,162,206,243,32,160,14,197,13,134,49,252,64,231,82,
                            211,63,89,117,190,55,93,59,80,62,31,161,180,255,140,40,228,212,185,17,
                            1,86,163,178,222,191,246,183,8,102,147,52,219,32,79,132,161,82,217,128,
                            115,135,32,72,224,72,191,91,153,38,163,19,189,171,144,240,58 };

    unsigned char *_res;
    unsigned int res_len;

    if(env_aes_gcm_128_encrypt(Input, sizeof(Input), CEK, Nonce, &_res, &res_len))
    {
        env_logWrite(LOG_TYPE_ERROR, "aes_gcm_test_big: env_aes_gcm_128_encrypt failed", 0);

        return 1;
    }

    if(res_len != sizeof(res))
    {
        env_logWrite(LOG_TYPE_ERROR, "aes_gcm_test_big failed: res_len error", 0);
        env_logWrite(LOG_TYPE_ERROR, "%u != %u", 2, res_len, sizeof(res));

        return 1;
    }

    if(memcmp(_res, res, res_len))
    {
        env_logWrite(LOG_TYPE_ERROR, "aes_gcm_test_big test failed: memcmp", 0);

        return 1;
    }

    free(_res);

    return 0;
}

int encryption_test()
{
    if(hkdf_test())
    {
        return 1;
    }

    if(create_info_chunk_test())
    {
        return 1;
    }

    if(aes_gcm_test())
    {
        return 1;
    }

    if(aes_gcm_test_big())
    {
        return 1;
    }

    env_logWrite(LOG_TYPE_INFO, "encryption tests passed!", 0);

    return 0;
}